<!DOCTYPE html>
<html ng-app="idbsDemo" xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
	
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" />
	<link rel="stylesheet" href="resources/css/idbsDemo.css"/>
	
	<title>IdBS Demo App</title>
</head>

<body ng-controller="IdbsDemoController">
	
	<div demo-navbar></div>
	
	<div class="container-fluid">
		<div class="row">
			<div class="col-sm-2">
				<div class="well">
					<h4>
						<span class="glyphicon glyphicon-user sidepanel-glyph"></span><a ng-click="changePanel('identities')" class="btn-link sidepanel-link">Identities</a>
						<span class="badge pull-right">2</span>
					</h4>
					<h4>
						<span class="glyphicon glyphicon-picture sidepanel-glyph"></span><a ng-click="changePanel('photos')" class="btn-link sidepanel-link">Photos</a>
						<span class="badge pull-right">{{resources.length}}</span>
					</h4>
				</div>
			</div>
			<div class="col-sm-10">
				<div ng-show="viewBoundUsers" class="well">
					<div class="row">	
						<div class="col-sm-1">
							<h2><span class="glyphicon glyphicon-exclamation-sign pull-right"></span></h2>
						</div>
						<div class="col-sm-11">	
							<h3>Detected {{boundUsers.length}} other users bound to this account:</h3>
							<ul class="list-unstyled bound-users-list">
								<li ng-repeat="u in boundUsers">
									<h4 class="text-primary">{{u.userInfo.name}}</h4>
									<h5 class="text-muted">{{u.subject}} @ {{u.issuer}}</h5>
								</li>
							</ul>
							<h3>Show their content?</h3>
							<div class="row" style="margin-left: 0px;">
								<button ng-click="boundUsersResponse(true)" class="btn btn-success">Yes</button>
								<button ng-click="boundUsersResponse(false)" class="btn btn-danger">Not now</button>
							</div>
							<h5>Note: This behavior can be configured later in the "Identities" tab.</h5>
						</div>
					</div>
				</div>
				
				<div ng-show="currentUser && panel == 'identities'" class="well">
					<h2>Welcome, {{currentUser.userInfo.name}}!</h2>
					<h4>Click the button below to reveal your associated identities.</h4>
					<div class="row">
						<div class="col-sm-12 text-center">
							<button class="btn btn-primary" ng-click="getToken()">Get identities</button>
						</div>
					</div>
					<div ng-show="identities.length" class="row">
						<div class="col-sm-12">
							<table class="table table-striped">
								<thead></thead>
								<tbody>
									<tr ng-repeat="i in identities">
										<td>
											<h3 class="text-primary">{{i.subject}}</h3>
											<h4>{{i.issuer}}</h4>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
				
				<div ng-show="currentUser && panel == 'photos'" class="well">
					<h2>Your Photos<a ng-click="addPhoto(true)" class="btn pull-right"><span class="glyphicon glyphicon-plus"></span></a></h2>
					<div ng-show="addphoto" class="row">
						<div class="col-sm-6 col-sm-offset-3">
							<div class="panel panel-default">
								<div class="panel-heading">
									<h4>Add a photo</h4>
								</div>
								<div class="panel-body">
									<form class="form-horizontal" name="addPhotoForm" action="/idbs-demo-webapp/addPhoto" method="post" ng-submit="getUserResources()">
										<div class="form-group">
											<label class="col-sm-2 control-label" for="photoUrlInput">URL:</label>
											<div class="col-sm-10">
												<input name="url" type="url" class="form-control" id="photoUrlInput" placeholder="Photo URL">
											</div>
										</div>
										<div class="form-group">
											<label class="col-sm-2 control-label" for="photoCaptionInput">Caption:</label>
											<div class="col-sm-10">
												<input name="caption" type="text" class="form-control" id="photoCaptionInput" placeholder="Caption">
											</div>
										</div>
										<div class="form-group">
											<div class="col-sm-offset-2 col-sm-2">
												<button type="submit" class="btn btn-success" ng-disabled="addPhotoForm.$invalid">Add</button>
											</div>
											<div class="col-sm-1">
												<button type="button" ng-click="addPhoto(false)" class="btn btn-danger">Cancel</button>
											</div>
										</div>
									</form>
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-sm-3" ng-repeat="r in resources">
							<div class="thumbnail">
								<img ng-src="{{r.url}}">
								<div class="caption">
									<h3>{{r.caption}}</h3>
									<h4 ng-show="showBoundUserContent">From {{r.author}}</h4>
									<h5>{{r.dateAdded}}</h5>
								</div>
							</div>
						</div>
					</div>
				</div>
				
				<div ng-hide="currentUser" class='well'>
					<div class="row">
						<div class="col-sm-12">
							<h2>You are not logged in</h2>
							<h4>Please log in to access this content.</h4>
						</div>
					</div>
				</div>
			</div>
		</div>
			
	</div>
	
	<script src="https://code.angularjs.org/1.3.16/angular.min.js"></script>
	
	<script src="resources/js/main.js"></script>
	<script src="resources/js/userInfoService.js"></script>
	<script src="resources/js/directives.js"></script>
</body>
</html>
